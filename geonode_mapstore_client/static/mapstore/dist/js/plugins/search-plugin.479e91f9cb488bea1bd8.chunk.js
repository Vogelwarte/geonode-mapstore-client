(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[65190],{460604:(e,t,r)=>{"use strict";r.d(t,{hn:()=>n,yg:()=>o,vD:()=>i,jJ:()=>a,oy:()=>c,W:()=>l,B1:()=>u,fU:()=>s,cY:()=>f});var n="ADDITIONALLAYER:ADD_ADDITIONAL_LAYERS",o="ADDITIONALLAYER:REMOVE_ADDITIONAL_LAYER",i="ADDITIONALLAYER:REMOVE_ALL_ADDITIONAL_LAYERS",a="ADDITIONALLAYER:UPDATE_ADDITIONAL_LAYER",c="ADDITIONALLAYER:UPDATE_OPTIONS_BY_OWNER",l=function(e,t){return{type:a,id:e,owner:t,actionType:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"override",options:arguments.length>3?arguments[3]:void 0}},u=function(e,t){return{type:c,owner:e,options:t}},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.owner;return{type:o,id:t,owner:r}},f=function(e){return{type:i,owner:e}}},115047:(e,t,r)=>{"use strict";r.d(t,{b:()=>d});var n=r(727418),o=r.n(n);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var u=r(59286),s=r(432420),f=["url","typeName","queriableAttributes","outputFormat","predicate","staticFilter","blacklist","item","fromTextToFilter","returnFullData"],p=function(e){var t,r=e.searchText,n=e.staticFilter,o=e.blacklist,i=e.item,a=e.queriableAttributes,c=e.predicate,l=(0,u.generateTemplateString)(n||"")(i),s=r.split(" ").filter((function(e){return e})).filter((function(e){return o.indexOf(e.toLowerCase())<0}));return 0===s.length&&(s=r?[r]:[]),s.length>0&&(t="(".concat(s.map((function(e){return a.map((function(t){return"".concat(t," ").concat(c," '%").concat(e.replace("'","''"),"%'")})).join(" OR ")})).join(") AND (")).concat(")")),t?t.concat(l):l||null},m={nominatim:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{returnFullData:!1};return r(647310).Z.geocode(e,t).then((function(e){return t.returnFullData?e:null===(r=e.data)?[]:r.map((function(e){return{properties:c({},e),id:e.osm_id,type:"Feature",bbox:e.boundingbox.map((function(e){return parseFloat(e)})).reduce((function(e,t,r){return e[function(e){switch(e){case 0:return 1;case 1:return 3;case 2:return 0;case 3:return 2;default:return-1}}(r)]=t,e}),[]),geometry:e.geojson||{type:"Point",coordinates:[parseFloat(e.lon),parseFloat(e.lat)]}}}));var r}))},wfs:function(e,t){var r=t.url,n=t.typeName,i=t.queriableAttributes,a=void 0===i?[]:i,c=t.outputFormat,l=void 0===c?"application/json":c,u=t.predicate,m=void 0===u?"ILIKE":u,y=t.staticFilter,d=void 0===y?"":y,b=t.blacklist,v=void 0===b?[]:b,h=t.item,g=t.fromTextToFilter,S=void 0===g?p:g,O=t.returnFullData,E=void 0!==O&&O,_=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(t,f),w=S({searchText:e,staticFilter:d,blacklist:v,item:h,queriableAttributes:a,predicate:m});return s.DH(r,o()({maxFeatures:10,typeName:n,outputFormat:l,cql_filter:w},_)).then((function(e){return E?e:e.features}))}},y={setService:function(e,t){m[e]=t},getService:function(e){return m[e]?m[e]:null}},d={Services:m,Utils:y}},838167:(e,t,r)=>{"use strict";r.d(t,{k9:()=>E,v0:()=>O,ZP:()=>w});var n=r(675263),o=r.n(n),i=r(124852),a=r.n(i),c=r(868195);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u.apply(null,arguments)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function f(e,t,r){return t=m(t),function(e,t){if(t&&("object"==l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,p()?Reflect.construct(t,r||[],m(e).constructor):t.apply(e,r))}function p(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(p=function(){return!!e})()}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function y(e,t){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},y(e,t)}function d(e,t,r){return(t=b(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e){var t=function(e,t){if("object"!=l(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}var v=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),f(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){return this.context.intl?a().createElement(c.FormattedDate,u({value:this.props.value},this.props.dateParams)):a().createElement("span",null,this.props.value&&this.props.value.toString()||"")}}])&&s(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(a().Component);d(v,"propTypes",{value:o().object,dateParams:o().object}),d(v,"contextTypes",{intl:o().object}),d(v,"defaultProps",{value:new Date});const h=v;var g=r(615402),S=r(805346),O=S.Z,E=g.Z,_=h;const w={Message:S.Z,HTML:E,DateFormat:_}},90973:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>sr});var n=r(227361),o=r.n(n),i=r(727418),a=r.n(i),c=r(675263),l=r.n(c),u=r(124852),s=r.n(u),f=r(171703),p=r(22222),m=r(460604),y=r(881808),d=r(782904),b=r(801550),v=r(597222);function h(e,t){return{type:"SET_SEARCH_BOOKMARK_CONFIG",property:e,value:t}}var g=r(480681),S=r(441609),O=r.n(S),E=r(618446),_=r.n(E),w=r(352353),P=r.n(w),j=r(805346),I=r(815135),T=r(423570),C=r.n(T);function k(){return k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},k.apply(null,arguments)}var R=(0,I.Z)(g.DropdownButton),x={disabled:!1,className:"square-button-md",noCaret:!0,idDropDown:C()()},A={title:s().createElement(g.Glyphicon,{glyph:"menu-hamburger"}),tooltipId:"search.changeSearchInputField",tooltipPosition:"bottom",className:"square-button-md no-border",pullRight:!0};const D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.menuItems,r=void 0===t?[]:t,n=e.disabled,o=void 0!==n&&n;return s().createElement(R,k({disabled:o},x,A),r.length?r.map((function(e){return e})):null)},F=function(e){var t=e.className,r=e.style,n=e.children;return s().createElement("div",{id:"map-search-bar",style:r,className:"MapSearchBar"+(t?" "+t:"")},n)};var N=r(86638);function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return V(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?V(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var L=function(e,t){var r=e.show,n=e.autoFocusOnSelect,o=void 0===n||n,i=e.selectedItems,a=void 0===i?[]:i,c=e.className,l=e.style,u=void 0===l?{textOverflow:"ellipsis"}:l,f=e.placeholder,p=e.placeholderMsgId,m=e.hideOnBlur,y=void 0===m||m,d=e.searchText,b=void 0===d?"":d,v=e.typeAhead,h=void 0===v||v,S=e.delay,O=void 0===S?1e3:S,E=e.blurResetDelay,_=void 0===E?300:E,w=e.onSearch,P=void 0===w?function(){}:w,j=e.onSearchTextChange,I=void 0===j?function(){}:j,T=e.onCancelSelectedItem,C=void 0===T?function(){}:T,k=e.onPurgeResults,R=void 0===k?function(){}:k,x=s().useRef(),A=s().useRef(),D=M(s().useState(),2),F=D[0],V=D[1],L=M(s().useState(),2),B=L[0],Z=L[1],G=M(s().useState(!1),2),q=G[0],z=G[1];s().useEffect((function(){var e=A.current;if(o&&a&&(e<a.length||!e&&1===a.length)){var t=x.current;t&&t.focus instanceof Function&&setTimeout((function(){return t.focus()}),200)}A.current=a&&a.length})),s().useEffect((function(){q&&(P(),z(!1))}),[q,P]);var U="search.addressSearch";if(!f&&t.messages){var Y=(0,N.S$)(t.messages,p||U);Y&&(U=Y)}else U=f;return r&&s().createElement(g.FormControl,{className:"searchInput".concat(c?" ".concat(c):""),key:"search-input",placeholder:U,type:"text",inputRef:function(e){x.current=e},style:u,value:b,onKeyDown:function(e){switch(e.keyCode){case 13:P();break;case 8:!b&&a&&a.length>0&&C(a[a.length-1])}},onBlur:function(){y&&(F&&clearTimeout(F),V(setTimeout((function(){R()}),_)))},onFocus:function(){h&&b&&P()},onChange:function(e){var t=e.target.value;I(t),h&&(B&&clearTimeout(B),Z(setTimeout((function(){z(!0)}),O)))}})};L.contextTypes={messages:l().object};const B=L;var Z=r(472986),G=r.n(Z),q=r(80717);function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function U(){return U=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},U.apply(null,arguments)}function Y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(r),!0).forEach((function(t){H(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function H(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=z(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==z(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const K=function(e){var t=e.loading,r=(e.splitTools,e.toolbarProps),n=void 0===r?{}:r,o=e.toolbarButtons,i=void 0===o?[]:o,c=e.children;return s().createElement("span",{className:"search-toolbar-options"},t&&s().createElement(G(),{style:a()({},{position:"absolute"},W({},{right:"69px",zIndex:1,top:"13px"})),spinnerName:"pulse",noFadeIn:!0}),s().createElement(q.Z,U({btnGroupProps:{className:"btn-group-menu-options"},transitionProps:null,btnDefaultProps:{className:"square-button-md",bsStyle:"primary"}},n,{buttons:i})),c)};var $=r(743129);function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}function Q(){return Q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Q.apply(null,arguments)}function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ee(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ee(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(Object(r),!0).forEach((function(t){ne(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ne(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=X(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=X(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==X(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var oe=(0,r(993451).Z)(["placeholder","clearValueText","noResultsText"])($.ZP),ie={searchByBookmark:function(e,t,r,n,o){var i,a,c=e.options,l=void 0===c?{}:c,u=e.layerVisibilityReload;void 0!==u&&u?t(re(re({},r),{},{map:re(re({},r.map),{},{bookmark_search_config:n})}),null,{bounds:[l.west,l.south,l.east,l.north],crs:(null==r||null===(i=r.map)||void 0===i||null===(a=i.center)||void 0===a?void 0:a.crs)||"EPSG:4326"}):l&&!O()(l)&&o([l.west,l.south,l.east,l.north],"EPSG:4326")},searchIcon:function(e,t){var r=t.onLayerVisibilityLoad,n=t.mapInitial,o=t.bookmarkConfig,i=t.onZoomToExtent;return{tooltipId:"bookmarkSearch"===e?"search.zoomToBookmark":"",tooltipPosition:"bottom",visible:"bookmarkSearch"===e&&!(null!=o&&o.zoomOnSelect),disabled:"bookmarkSearch"===e&&!o.selected,onClick:function(){"bookmarkSearch"===e&&ie.searchByBookmark(o.selected,r,n,o.bookmarkSearchConfig||{},i)}}}},ae=function(e){var t=e.bookmarkConfig,r=e.onPropertyChange,n=e.onLayerVisibilityLoad,o=e.mapInitial,i=e.onZoomToExtent,a=J((0,u.useState)([]),2),c=a[0],l=a[1],f=t||{},p=f.selected,m=void 0===p?{}:p,y=f.bookmarkSearchConfig,d=void 0===y?{}:y,b=f.zoomOnSelect,v=void 0===b||b,h=d.bookmarks,g=void 0===h?[]:h,S=ie.searchByBookmark;return(0,u.useEffect)((function(){O()(g)||l(g.map((function(e){return e.title})))}),[g]),s().createElement("div",{className:"search-select"},s().createElement("div",{style:{flex:"1 1 0%",padding:"0px 4px"}},s().createElement(oe,Q({},{clearable:!0,isSearchable:!0,isClearable:!0},{onChange:function(e){var t=e&&e.value||"",a=J(g.filter((function(r,n){return r.title===t&&n===e.idx})),1)[0];r("selected",a),v&&S(a,n,o,d,i)},value:(null==m?void 0:m.title)||"",options:c.map((function(e,t){return{label:e,value:e,idx:t}})),placeholder:"search.b_placeholder",clearValueText:"search.b_clearvalue",noResultsText:"search.b_noresult"}))))};ae.propTypes={bookmarkConfig:l().object.isRequired,onPropertyChange:l().func.isRequired};const ce=(0,f.connect)((function(e){return{bookmarkConfig:e.searchbookmarkconfig||{}}}),{onPropertyChange:h,onZoomToExtent:b.Px,onLayerVisibilityLoad:y.H0})(ae);var le=r(281763),ue=r.n(le),se=r(799509),fe=r(777900),pe={clearCoordinates:function(e,t){e({owner:"search"}),t("lat",""),t("lon","")},areValidCoordinates:function(e){return ue()(null==e?void 0:e.lon)&&ue()(null==e?void 0:e.lat)},zoomToPoint:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12;e({x:parseFloat(t.lon),y:parseFloat(t.lat)},r,"EPSG:4326")},coordinateFormatChange:function(e,t,r,n){return{buttonConfig:{title:s().createElement(g.Glyphicon,{glyph:"cog"}),tooltipId:"search.changeSearchInputField",tooltipPosition:"bottom",className:"square-button-md no-border",pullRight:!0},menuOptions:[{active:"decimal"===e,onClick:function(){return t("decimal")},text:s().createElement(j.Z,{msgId:"search.decimal"})},{active:"aeronautical"===e,onClick:function(){return t("aeronautical")},text:s().createElement(j.Z,{msgId:"search.aeronautical"})}],visible:r&&"coordinatesSearch"===n,Element:fe.Z}},removeIcon:function(e,t,r,n){return{visible:"coordinatesSearch"===e&&(ue()(t.lon)||ue()(t.lat)),onClick:function(){return pe.clearCoordinates(r,n)}}},searchIcon:function(e,t,r,n){return{visible:"coordinatesSearch"===e,onClick:function(){"coordinatesSearch"===e&&pe.areValidCoordinates(t)&&pe.zoomToPoint(r,t,n)}}},coordinatesMenuItem:function(e){var t=e.activeTool,r=e.searchText,n=e.clearSearch,o=e.onChangeActiveSearchTool,i=e.onClearBookmarkSearch;return s().createElement(g.MenuItem,{active:"coordinatesSearch"===t,onClick:function(){void 0!==r&&""!==r&&n(),i("selected"),o("coordinatesSearch"),document.dispatchEvent(new MouseEvent("click"))}},s().createElement(g.Glyphicon,{glyph:"search-coords"})," ",s().createElement(j.Z,{msgId:"search.coordinatesSearch"}))}},me=function(e){var t=e.coordinate,r=void 0===t?{}:t,n=e.format,o=e.onClearCoordinatesSearch,i=e.onZoomToPoint,a=e.onChangeCoord,c=e.defaultZoomLevel,l=e.aeronauticalOptions,u=void 0===l?{seconds:{decimals:4,step:1e-4}}:l,f=e.constraintsCoordEditor,p=void 0===f?{decimal:{lat:{min:-90,max:90},lon:{min:-180,max:180}}}:f,m=pe.zoomToPoint,y=pe.areValidCoordinates,d=function(e,t){a(e,parseFloat(t)),y()||o({owner:"search"})},b=function(){m(i,r,c)};return s().createElement("div",{className:"coordinateEditor",style:{flexWrap:"decimal"===n?"nowrap":"wrap"}},s().createElement(g.Row,{className:"entryRow ".concat(n)},s().createElement(g.FormGroup,null,s().createElement(g.InputGroup,null,s().createElement(g.InputGroup.Addon,{style:{minWidth:45}},s().createElement(j.Z,{msgId:"search.latitude"})),s().createElement(se.Z,{format:n,aeronauticalOptions:u,coordinate:"lat",idx:1,value:r.lat,constraints:p,onChange:function(e){return d("lat",e)},onKeyDown:function(){y(r)&&b()}})))),s().createElement(g.Row,{className:"entryRow ".concat(n)},s().createElement(g.FormGroup,null,s().createElement(g.InputGroup,null,s().createElement(g.InputGroup.Addon,{style:{minWidth:45}},s().createElement(j.Z,{msgId:"search.longitude"})),s().createElement(se.Z,{format:n,aeronauticalOptions:u,coordinate:"lon",idx:2,value:r.lon,constraints:p,onChange:function(e){return d("lon",e)},onKeyDown:function(){y(r)&&b()}})))))};me.propTypes={coordinate:l().object,format:l().string,onClearCoordinatesSearch:l().func,onZoomToPoint:l().func,onChangeCoord:l().func,defaultZoomLevel:l().number};const ye=(0,f.connect)((function(e){return{coordinate:e.search.coordinate||{}}}),{onZoomToPoint:v.Z,onChangeCoord:v.TS})(me);function de(e){return de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},de(e)}var be=["activeSearchTool","removeIcon","searchIcon","isSearchClickable","splitTools","searchText","maxResults","searchOptions","loading","delay","blurResetDelay","typeAhead","coordinate","selectedItems","defaultZoomLevel","enabledSearchBookmarkConfig","error","format","placeholder","placeholderMsgId","showOptions","showAddressSearchOption","showCoordinatesSearchOption","showBookMarkSearchOption","onSearch","onSearchReset","onSearchTextChange","onCancelSelectedItem","onChangeCoord","onChangeActiveSearchTool","onClearCoordinatesSearch","onChangeFormat","onToggleControl","onZoomToPoint","onClearBookmarkSearch","onPurgeResults","items"];function ve(e){return function(e){if(Array.isArray(e))return _e(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Ee(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function he(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ge(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?he(Object(r),!0).forEach((function(t){Se(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):he(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Se(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=de(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=de(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==de(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||Ee(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ee(e,t){if(e){if("string"==typeof e)return _e(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_e(e,t):void 0}}function _e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var we=(0,I.Z)(g.MenuItem),Pe=function(e){var t=e.activeTool,r=e.searchIcon,n=e.services,i=void 0===n?[]:n,a=e.selectedService,c=void 0===a?-1:a,l=e.onServiceSelect,u=void 0===l?function(){}:l;return 0===i.length?null:1===i.length?s().createElement(g.MenuItem,{active:"addressSearch"===t,onClick:function(){return u(-1)}},s().createElement(g.Glyphicon,{glyph:r}),s().createElement(j.Z,{msgId:"search.addressSearch"})):s().createElement(s().Fragment,null,s().createElement(we,{tooltipId:"search.searchOnAllServices",tooltipPosition:"left",active:"addressSearch"===t&&-1===c,onClick:function(){return u(-1)}},s().createElement(g.Glyphicon,{glyph:r}),s().createElement(j.Z,{msgId:"search.addressSearch"})),i.map((function(e,n){var i=e.name||e.type;return s().createElement(we,{tooltip:o()(e,"options.tooltip","Search on ".concat(i)),tooltipPosition:"left",onClick:function(){return u(n)},key:n,active:"addressSearch"===t&&c===n},s().createElement("span",{style:{marginLeft:20}},s().createElement(g.Glyphicon,{glyph:r}),i))})),s().createElement(g.MenuItem,{divider:!0}))},je=r(313311),Ie=r.n(je),Te=r(59286);function Ce(e){return Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ce(e)}function ke(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ne(n.key),n)}}function Re(e,t,r){return t=Ae(t),function(e,t){if(t&&("object"==Ce(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,xe()?Reflect.construct(t,r||[],Ae(e).constructor):t.apply(e,r))}function xe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(xe=function(){return!!e})()}function Ae(e){return Ae=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ae(e)}function De(e,t){return De=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},De(e,t)}function Fe(e,t,r){return(t=Ne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ne(e){var t=function(e,t){if("object"!=Ce(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=Ce(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ce(t)?t:t+""}var Me=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Fe(e=Re(this,t,[].concat(n)),"onClick",(function(){var t=e.props.item;e.props.onItemClick(t)})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&De(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){if(void 0===this.props.item)return null;var e=this.props.item;return s().createElement("div",{key:e.osm_id,className:"search-result",style:e.resultCssStyle,onClick:this.onClick},s().createElement("div",{className:"search-result-left-container"},s().createElement("div",{className:"icon"}," ",s().createElement("img",{src:e.icon})),s().createElement("div",{className:"text-result-title"},o()(e,this.props.displayName)||(0,Te.generateTemplateString)(this.props.displayName||"")(e)),s().createElement("small",{className:"text-info"},this.props.subTitle&&o()(e,this.props.subTitle)||(0,Te.generateTemplateString)(this.props.subTitle||"")(e))),s().createElement("div",{className:"search-result-right-container"},s().createElement("div",{className:"search-result-tools"},s().createElement(q.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary"},buttons:this.props.tools}))))}}])&&ke(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(s().Component);Fe(Me,"propTypes",{subTitle:l().string,item:l().object,displayName:l().string,idField:l().string,icon:l().string,onItemClick:l().func,tools:l().array}),Fe(Me,"defaultProps",{displayName:"properties.display_name",idField:"id",icon:"properties.icon",tools:[]});const Ve=Me;var Le=r(838167),Be=r(218412);function Ze(e){return Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ze(e)}function Ge(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,He(n.key),n)}}function qe(e,t,r){return t=Ue(t),function(e,t){if(t&&("object"==Ze(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ze()?Reflect.construct(t,r||[],Ue(e).constructor):t.apply(e,r))}function ze(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ze=function(){return!!e})()}function Ue(e){return Ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ue(e)}function Ye(e,t){return Ye=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ye(e,t)}function We(e,t,r){return(t=He(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function He(e){var t=function(e,t){if("object"!=Ze(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=Ze(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ze(t)?t:t+""}var Ke=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return We(e=qe(this,t,[].concat(n)),"onItemClick",(function(t){e.props.onItemClick(t,e.props.mapConfig)})),We(e,"renderResults",(function(){return e.props.results.map((function(t,r){var n,o=e.findService(t)||{},i=Ie()(e.props.layers,{name:null===(n=o.options)||void 0===n?void 0:n.typeName}),a=(0,Be.zA)(o),c=!(0,Be.Tv)(i,o);return s().createElement(Ve,{subTitle:o.subTitle,idField:o.idField,displayName:o.displayName,key:t.osm_id||t.id||"res_"+r,item:t,onItemClick:e.onItemClick,tools:[{id:"open-gfi",keyProp:"open-gfi",visible:a,disabled:c,glyph:"info-sign",tooltipId:a&&c?"search.layerMustBeVisible":"search.showGFI",onClick:function(r){r.stopPropagation(),e.props.showGFI(t)}}]})}))})),We(e,"findService",(function(t){var r=e.props.searchOptions&&e.props.searchOptions.services;if(null!==t.__SERVICE__)if(r&&"string"==typeof t.__SERVICE__){for(var n=0;n<r.length;n++)if(r[n]&&r[n].id===t.__SERVICE__)return r[n];for(var o=0;o<r.length;o++)if(r[o]&&r[o].type===t.__SERVICE__)return r[o]}else if("object"===Ze(t.__SERVICE__))return t.__SERVICE__;return null})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ye(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this.props.notFoundMessage;e||(e=s().createElement(Le.ZP.Message,{msgId:"noresultfound"}));var t=this.props.containerStyle,r=this.props.mapConfig&&this.props.mapConfig.size;if(this.props.fitToMapSize&&r){var n=r.width-this.props.sizeAdjustment.width,o=r.height-this.props.sizeAdjustment.height;t=a()({},this.props.containerStyle,{maxWidth:n,maxHeight:o})}return this.props.results?0===this.props.results.length?s().createElement("div",{className:"search-result-list",style:a()({padding:"10px",textAlign:"center"},t)},e):s().createElement("div",{className:"search-result-list",style:t},this.renderResults()):null}}])&&Ge(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(s().Component);We(Ke,"propTypes",{results:l().array,layers:l().array,searchOptions:l().object,mapConfig:l().object,fitToMapSize:l().bool,containerStyle:l().object,sizeAdjustment:l().object,onItemClick:l().func,addMarker:l().func,afterItemClick:l().func,showGFI:l().func,notFoundMessage:l().oneOfType([l().object,l().string])}),We(Ke,"defaultProps",{layers:[],sizeAdjustment:{width:0,height:110},containerStyle:{zIndex:1e3},onItemClick:function(){},addMarker:function(){},afterItemClick:function(){},showGFI:function(){}});var $e=r(49977),Xe=r(294707),Qe=r.n(Xe),Je=r(235385),et=r.n(Je),tt=r(414293),rt=r.n(tt),nt=r(189734),ot=r.n(nt),it=r(455877),at=r.n(it),ct=r(675110),lt=r(921914),ut=r(580416),st=r(986267),ft=r(115047),pt=r(432420),mt=r(396606),yt=r(307877),dt=r(73814),bt=r(821751),vt=r(800827);function ht(e){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ht(e)}function gt(e){return function(e){if(Array.isArray(e))return St(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return St(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?St(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function St(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Ot(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Et(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ot(Object(r),!0).forEach((function(t){_t(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ot(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _t(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=ht(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ht(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var wt=function(e,t){return(0,mt.mx)(e,Et({},(0,yt.oq)(t)))},Pt=r(426125);function jt(e){return jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jt(e)}function It(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Tt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?It(Object(r),!0).forEach((function(t){Ct(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):It(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ct(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=jt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=jt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==jt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kt(e){return function(e){if(Array.isArray(e))return Rt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Rt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Rt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var xt=r(737275),At=r(38560);function Dt(e){return Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dt(e)}function Ft(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zt(n.key),n)}}function Nt(e,t,r){return t=Vt(t),function(e,t){if(t&&("object"==Dt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Mt()?Reflect.construct(t,r||[],Vt(e).constructor):t.apply(e,r))}function Mt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Mt=function(){return!!e})()}function Vt(e){return Vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Vt(e)}function Lt(e,t){return Lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Lt(e,t)}function Bt(e,t,r){return(t=Zt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zt(e){var t=function(e,t){if("object"!=Dt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=Dt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Dt(t)?t:t+""}var Gt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Nt(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Lt(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this;return s().createElement(At.Z,{onClick:function(){return e.props.onToggle(e.props.pressed)},bsStyle:this.props.pressed?"default":"primary",className:"square-button"},s().createElement(g.Glyphicon,{glyph:"search"}))}}])&&Ft(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(s().Component);Bt(Gt,"propTypes",{pressed:l().bool,onToggle:l().func}),Bt(Gt,"defaultProps",{pressed:!1,onToggle:function(){}});const qt=(0,f.connect)((function(e){return{pressed:e.controls&&e.controls.search&&e.controls.search.enabled||!1}}),{onToggle:d.Xi.bind(null,"search",null)})(Gt);var zt,Ut=r(55105),Yt=r(294184),Wt=r.n(Yt);function Ht(e){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ht(e)}function Kt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $t(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Kt(Object(r),!0).forEach((function(t){nr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Xt(){return Xt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xt.apply(null,arguments)}function Qt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,or(n.key),n)}}function Jt(e,t,r){return t=tr(t),function(e,t){if(t&&("object"==Ht(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,er()?Reflect.construct(t,r||[],tr(e).constructor):t.apply(e,r))}function er(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(er=function(){return!!e})()}function tr(e){return tr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},tr(e)}function rr(e,t){return rr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},rr(e,t)}function nr(e,t,r){return(t=or(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function or(e){var t=function(e,t){if("object"!=Ht(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=Ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ht(t)?t:t+""}var ir=(0,p.P1)([function(e){return e.search||null},function(e){return e.controls&&e.controls.searchBookmarkConfig||null},function(e){return e.mapConfigRawData||{}},function(e){return(null==e?void 0:e.searchbookmarkconfig)||""}],(function(e,t,r,n){return{enabledSearchBookmarkConfig:t&&t.enabled||!1,error:e&&e.error,coordinate:e&&e.coordinate||{},loading:e&&e.loading,searchText:e?e.searchText:"",activeSearchTool:o()(e,"activeSearchTool","addressSearch"),format:o()(e,"format")||xt.ZP.getConfigProp("defaultCoordinateFormat"),selectedItems:e&&e.selectedItems,mapInitial:r,bookmarkConfig:n||{}}})),ar=(0,f.connect)(ir,{onSearch:v.tt,onChangeCoord:v.TS,onChangeActiveSearchTool:v.a,onClearCoordinatesSearch:m.fU,onClearBookmarkSearch:h,onChangeFormat:v.Zw,onToggleControl:d.Xi,onZoomToPoint:v.Z,onPurgeResults:v.kV,onSearchReset:v.v2,onSearchTextChange:v.k9,onCancelSelectedItem:v.KG,onZoomToExtent:b.Px,onLayerVisibilityLoad:y.H0})((function(e){var t,r,n=e.activeSearchTool,i=void 0===n?"addressSearch":n,a=e.removeIcon,c=void 0===a?"1-close":a,l=e.searchIcon,f=void 0===l?"search":l,p=e.isSearchClickable,m=void 0===p||p,y=e.splitTools,d=e.searchText,b=void 0===d?"":d,v=e.maxResults,h=void 0===v?15:v,S=e.searchOptions,E=e.loading,w=e.delay,I=e.blurResetDelay,T=e.typeAhead,C=e.coordinate,k=void 0===C?{}:C,R=e.selectedItems,x=void 0===R?[]:R,A=e.defaultZoomLevel,N=void 0===A?12:A,M=e.enabledSearchBookmarkConfig,V=void 0!==M&&M,L=e.error,Z=e.format,G=void 0===Z?"decimal":Z,q=e.placeholder,z=e.placeholderMsgId,U=void 0===z?"search.addressSearch":z,Y=e.showOptions,W=void 0===Y||Y,H=e.showAddressSearchOption,$=void 0===H||H,X=e.showCoordinatesSearchOption,Q=void 0===X||X,J=e.showBookMarkSearchOption,ee=void 0===J||J,te=e.onSearch,re=e.onSearchReset,ne=e.onSearchTextChange,oe=e.onCancelSelectedItem,ae=e.onChangeCoord,le=void 0===ae?function(){}:ae,ue=e.onChangeActiveSearchTool,se=void 0===ue?function(){}:ue,fe=e.onClearCoordinatesSearch,me=void 0===fe?function(){}:fe,de=e.onChangeFormat,he=void 0===de?function(){}:de,Se=e.onToggleControl,Ee=void 0===Se?function(){}:Se,_e=e.onZoomToPoint,we=void 0===_e?function(){}:_e,je=e.onClearBookmarkSearch,Ie=void 0===je?function(){}:je,Te=e.onPurgeResults,Ce=e.items,ke=void 0===Ce?[]:Ce,Re=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,be),xe=Oe((0,u.useState)(-1),2),Ae=xe[0],De=xe[1];(0,u.useEffect)((function(){_()(null==S?void 0:S.services,null==S?void 0:S.services)||De(-1)}),[null==S?void 0:S.services]);var Fe,Ne=null!==(t=null==S||null===(r=S.services)||void 0===r?void 0:r.filter((function(e,t){return!(Ae>=0)||Ae===t})))&&void 0!==t?t:[],Me=function(e){var t=e.searchText,r=e.selectedItems,n=e.searchOptions,o=e.maxResults,i=e.onSearch,a=void 0===i?function(){}:i,c=e.onSearchReset,l=void 0===c?function(){}:c;return function(){var e=t,i=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(t,r){var n;return t+((null==r||null===(n=r.options)||void 0===n?void 0:n.maxFeatures)||e)}),0)||e}(null==n?void 0:n.services,o);void 0!==e&&""!==e||r&&0!==r.length?void 0!==e&&""!==e&&a(e,n,i):l()}}({searchText:b,selectedItems:x,searchOptions:ge(ge({},S),{},{services:Ne}),maxResults:h,onSearch:te,onSearchReset:re}),Ve=function(){re()},Le=[];if($&&Le.push(s().createElement(Pe,{searchIcon:f,activeTool:i,selectedService:Ae,onServiceSelect:function(e){De(-1===e?void 0:e),me({owner:"search"}),Ie("selected"),se("addressSearch")},services:null==S?void 0:S.services})),Q&&Le.push(s().createElement(pe.coordinatesMenuItem,{activeTool:i,searchText:b,clearSearch:Ve,onChangeActiveSearchTool:se,onClearBookmarkSearch:Ie})),ee&&!O()(ke)){var Be,Ze=Re.bookmarkConfig||{},Ge=Ze.allowUser,qe=Ze.bookmarkSearchConfig,ze=ke.find((function(e){return"SearchByBookmark"===e.name}))||{};if(ze.menuItem){var Ue=ze.menuItem;Le.push(s().createElement(Ue,null))}ze.bookmarkConfig&&(Fe=ge(ge({},ze.bookmarkConfig(Ee,V,i)),!Ge&&{visible:!1})),Ge||0!==(null==qe||null===(Be=qe.bookmarks)||void 0===Be?void 0:Be.length)||"bookmarkSearch"!==i||se("addressSearch")}var Ye,We=function(){if(W){if("coordinatesSearch"===i)return pe.coordinateFormatChange(G,he,W,i);if("bookmarkSearch"===i)return Fe}return null};return s().createElement(F,null,s().createElement(g.FormGroup,null,s().createElement("div",{className:"input-group",style:{display:"flex"}},x&&x.map((function(e,t){return s().createElement("span",{key:"selected-item"+t,className:"input-group-addon"},s().createElement("div",{className:"selectedItem-text"},e.text))})),s().createElement(B,{show:"addressSearch"===i,delay:w,typeAhead:T,blurResetDelay:I,placeholder:function(){var e;if(!q&&1===(null==Ne?void 0:Ne.length)&&(null==S||null===(e=S.services)||void 0===e?void 0:e.length)>1){var t=Oe(Ne,1)[0],r=t.name||t.type;return o()(t,"options.placeholder","Search by ".concat(r))}return q}(),placeholderMsgId:U,searchText:b,selectedItems:x,onSearch:Me,onSearchTextChange:ne,onCancelSelectedItem:oe,onPurgeResults:Te}),"coordinatesSearch"===i&&Q&&s().createElement(ye,{format:G,defaultZoomLevel:N,onClearCoordinatesSearch:me}),"bookmarkSearch"===i&&ee&&s().createElement(ce,{mapInitial:Re.mapInitial}),s().createElement(K,{splitTools:!1,toolbarButtons:[].concat(ve(We()?[ge({},We())]:[]),ve(ke.filter((function(e){return"button"===e.target})).map((function(e){var t=e.component;return{visible:!!W,Element:t}}))),[ge({glyph:c,className:"square-button-md no-border",bsStyle:"default",pullRight:!0,loading:!P()(E)&&E,visible:"addressSearch"===i&&(""!==b||x&&x.length>0),onClick:function(){"addressSearch"===i&&Ve()}},"coordinatesSearch"===i&&pe.removeIcon(i,k,me,le)),ge(ge({glyph:f,className:"square-button-md no-border "+(m||"addressSearch"!==i?"magnifying-glass clickable":"magnifying-glass"),bsStyle:"default",pullRight:!0,tooltipPosition:"bottom",visible:!("addressSearch"!==i||(""!==b||x&&x.length>0)&&y),onClick:function(){return m&&Me()}},"coordinatesSearch"===i&&pe.searchIcon(i,k,we,N)),"bookmarkSearch"===i&&ie.searchIcon(i,Re)),{tooltip:(Ye=L,Ye?s().createElement(j.Z,{msgId:Ye.msgId||"search.generic_error",msgParams:{message:Ye.message,serviceType:Ye.serviceType}}):null),tooltipPosition:"bottom",className:"square-button-md no-border",glyph:"warning-sign",bsStyle:"danger",glyphClassName:"searcherror",visible:!!L,onClick:Ve},{visible:W,renderButton:s().createElement(D,{disabled:W,menuItems:Le})}])}))))})),cr=(0,p.P1)([vt.Od,ct.l2,function(e){return e.search||null}],(function(e,t,r){return{mapConfig:e,layers:t,results:r?r.results:null}})),lr=(0,f.connect)(cr,{onItemClick:v.Jc,addMarker:v._q,showGFI:v.w4})(Ke),ur=(0,f.connect)((function(e){return{enabled:e.controls&&e.controls.search&&e.controls.search.enabled||!1,selectedServices:e&&e.search&&e.search.selectedServices,selectedItems:e&&e.search&&e.search.selectedItems,textSearchConfig:e&&e.searchconfig&&e.searchconfig.textSearchConfig}}),{onUpdateResultsStyle:v.o$})((zt=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return nr(e=Jt(this,t,[].concat(n)),"getServiceOverrides",(function(t){return e.props.selectedItems&&e.props.selectedItems[e.props.selectedItems.length-1]&&o()(e.props.selectedItems[e.props.selectedItems.length-1],t)})),nr(e,"getSearchOptions",(function(){var t=e.props,r=t.searchOptions,n=t.textSearchConfig;return n&&n.services&&n.services.length>0?n.override?a()({},r,{services:n.services}):a()({},r,{services:r.services.concat(n.services)}):r})),nr(e,"getCurrentServices",(function(){var t=e.props.selectedServices,r=e.getSearchOptions();return t&&t.length>0?a()({},r,{services:t}):r})),nr(e,"searchFitToTheScreen",(function(){var t=e.props,r=t.offsets,n=r.right,o=r.left,i=t.mapSize.width;return(void 0===i?window.innerWidth:i)-n-o-60>=500})),nr(e,"getSearchAndToggleButton",(function(){var t=s().createElement(ar,Xt({key:"searchBar"},e.props,{searchOptions:e.getCurrentServices(),placeholder:e.getServiceOverrides("placeholder"),placeholderMsgId:e.getServiceOverrides("placeholderMsgId")}));return e.searchFitToTheScreen()?t:s().createElement(s().Fragment,null,s().createElement(qt,null),e.props.enabled?t:null)})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rr(e,t)}(t,e),r=t,(n=[{key:"componentDidMount",value:function(){this.props.onUpdateResultsStyle($t($t({},Be.be),this.props.resultsStyle))}},{key:"render",value:function(){return s().createElement("span",{id:"search-bar-container",className:Wt()({toggled:!this.searchFitToTheScreen(),"no-sidebar":!this.props.sidebarIsActive}),style:this.props.sidebarIsActive?this.props.style:null},this.getSearchAndToggleButton(),s().createElement(lr,{fitToMapSize:this.props.fitResultsToMapSize,searchOptions:this.props.searchOptions,onUpdateResultsStyle:this.props.onUpdateResultsStyle,key:"nominatimresults"}))}}])&&Qt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(s().Component),nr(zt,"propTypes",{splitTools:l().bool,showOptions:l().bool,isSearchClickable:l().bool,fitResultsToMapSize:l().bool,searchOptions:l().object,resultsStyle:l().object,selectedItems:l().array,selectedServices:l().array,userServices:l().array,withToggle:l().oneOfType([l().bool,l().array]),enabled:l().bool,textSearchConfig:l().object,style:l().object,sidebarIsActive:l().bool}),nr(zt,"defaultProps",{searchOptions:{services:[{type:"nominatim",priority:5}]},isSearchClickable:!1,splitTools:!0,resultsStyle:{color:"#3388ff",weight:4,dashArray:"",fillColor:"#3388ff",fillOpacity:.2},fitResultsToMapSize:!0,withToggle:!1,enabled:!0,style:{},sidebarIsActive:!1}),zt));const sr={SearchPlugin:a()((0,f.connect)((0,p.zB)({style:function(e){return(0,Ut.ic)(e,{right:!0})},offsets:function(e){return(0,Ut.ic)(e,{right:!0,left:!0})},mapSize:function(e){return(0,vt.GV)({width:!0})(e)},sidebarIsActive:function(e){return function(e){return o()(e,"controls.sidebarMenu.enabled",!1)}(e)}}),{})(ur),{OmniBar:{name:"search",position:1,tool:!0,priority:1}}),epics:{searchEpic:function(e){return e.ofType(v.bj).debounceTime(250).switchMap((function(t){return $e.Observable.from((t.services||[{type:"nominatim",priority:5}]).map((function(e){var r=ft.b.Utils.getService(e.type);if(!r){var n=new Error("Service Missing");return n.msgId="search.service_missing",n.serviceType=e.type,$e.Observable.of(n).do((function(e){throw e}))}return $e.Observable.defer((function(){return r(t.searchText,e.options).then((function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(t){return Et(Et({},t),{},{__SERVICE__:e,__PRIORITY__:e.priority||0})}))}))})).retryWhen((function(e){return e.delay(200).scan((function(e,t){if(e>=2)throw t;return e+1}),0)}))}))).mergeAll().scan((function(e,t){return ot()([].concat(gt(e),gt(t)),["__PRIORITY__"])})).map((function(e){return(0,v.WN)(e.slice(0,t.maxResults||15),!1)})).startWith((0,v.yo)(!0)).takeUntil(e.ofType(v.Av,v.M8,v.dX)).concat([(0,v.yo)(!1)]).catch((function(e){var t=Et(Et({msgId:"search.generic_error"},e),{},{message:e.message,stack:e.stack});return $e.Observable.from([(0,v.kE)(t),(0,v.yo)(!1)])}))}))},searchOnStartEpic:function(e,t){return e.ofType(v.Vc).switchMap((function(e){var r=e.layer,n=e.cql_filter,o=t.getState();if(0===(0,ct.OX)(o).filter((function(e){return e.name===r})).length)return $e.Observable.of((0,v.Tw)());var i=(0,ct.dT)(o,r);return i&&n?$e.Observable.defer((function(){return(0,pt.DH)(i.url,{maxFeatures:1,typeName:r,srsName:"EPSG:4326",outputFormat:"application/json",cql_filter:n}).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.features&&e.features.length&&Et(Et({},e.features[0]),{},{typeName:r})}))})).switchMap((function(e){var r=e.type,o=e.geometry,i=e.typeName,a=et()({type:r,geometry:o}).geometry.coordinates;if(a){var c,l={lng:a[0],lat:a[1]},u=(0,vt.uy)(t.getState()),s=(0,st.reproject)(a,"EPSG:4326",u),f=s.x,p=s.y;return c=(0,yt.xt)(t.getState())?$e.Observable.of((0,dt.i8)(at()(),{component:bt.IDENTIFY_POPUP,maxWidth:600,position:{coordinates:[f,p]}})):$e.Observable.of((0,lt.HP)()),$e.Observable.of((0,lt.lK)({latlng:l},i,[i],_t({},i,{cql_filter:n}))).merge(c)}return $e.Observable.empty()})).catch((function(){return $e.Observable.of((0,v.I3)())})):$e.Observable.empty()}))},searchItemSelected:function(e,t){return e.ofType(v.dX).switchMap((function(e){var r=$e.Observable.of(e.item).concatMap((function(t){if(t&&t.__SERVICE__&&t.__SERVICE__.geomService){var r=(0,Te.generateTemplateString)(t.__SERVICE__.geomService.options.staticFilter||"")(t);return $e.Observable.fromPromise(ft.b.Utils.getService(t.__SERVICE__.geomService.type)("",a()({},t.__SERVICE__.geomService.options,{staticFilter:r})).then((function(e){return a()({},t,{geometry:st.default.mergeToPolyGeom(e)})})))}return $e.Observable.of(e.item)})).concatMap((function(e){var r=e.bbox||e.properties.bbox||Qe()(e),n=[(0,b.Px)([r[0],r[1],r[2],r[3]],"EPSG:4326",e.__SERVICE__&&e.__SERVICE__.options&&e.__SERVICE__.options.maxZoomLevel||21),(0,v._q)(e)];if(e.__SERVICE__&&!rt()(e.__SERVICE__.launchInfoPanel)&&e.__SERVICE__.options&&e.__SERVICE__.options.typeName){var o=et()(e).geometry.coordinates,i={lng:o[0],lat:o[1]},a=e.__SERVICE__.options.typeName;if(o){var c=t.getState(),l=a&&(0,ct.dT)(c,a),u=null,s=[],f={},p=!1;return"single_layer"===e.__SERVICE__.launchInfoPanel&&(p=e.__SERVICE__.forceSearchLayerVisibility,s=[a],u=e.id,f=_t({},e.__SERVICE__.options.typeName,Et({info_format:wt(l,c)},u?{featureid:u,CQL_FILTER:void 0}:{}))),[].concat(gt(p&&l?[(0,ut.He)(l.id,{visibility:!0})]:[]),gt(e.__SERVICE__.openFeatureInfoButtonEnabled?[]:[(0,lt.lK)({latlng:i},a,s,f,u)]),[(0,lt.HP)()],n)}}return n})),n=e.item,o=n&&n.__SERVICE__&&n.__SERVICE__.then,i=o?$e.Observable.of((0,v.QJ)(o.map((function(e){return Et(Et({},e),{},{options:Et({item:n},e.options)})})),{text:(0,Te.generateTemplateString)(n.__SERVICE__.displayName||"")(n),placeholder:n.__SERVICE__.nestedPlaceholder&&(0,Te.generateTemplateString)(n.__SERVICE__.nestedPlaceholder||"")(n),placeholderMsgId:n.__SERVICE__.nestedPlaceholderMsgId&&(0,Te.generateTemplateString)(n.__SERVICE__.nestedPlaceholderMsgId||"")(n)},(0,Te.generateTemplateString)(n.__SERVICE__.searchTextTemplate||"")(n))):$e.Observable.empty(),c=n.__SERVICE__&&n.__SERVICE__.searchTextTemplate,l=c?$e.Observable.of((0,v.k9)((0,Te.generateTemplateString)(c)(n))):$e.Observable.empty();return $e.Observable.of((0,v.kV)()).concat(r,i,l)}))},zoomAndAddPointEpic:function(e,t){return e.ofType(v.b4).switchMap((function(e){var r={type:"Feature",geometry:{type:"Point",coordinates:[e.pos.x,e.pos.y]}},n=t.getState();return $e.Observable.from([(0,m.W)("search","search","overlay",{features:[r],type:"vector",name:"searchPoints",id:"searchPoints",visibility:!0,style:n.search&&n.search.style||Be.be}),(0,b.xy)(e.pos,e.zoom,e.crs)])}))},textSearchShowGFIEpic:function(e,t){return e.ofType(v.al).filter((function(e){var t,r=e.item,n=void 0===r?{}:r;return!(null!=n&&null!==(t=n.__SERVICE__)&&void 0!==t&&t.customGFI)})).switchMap((function(r){var n,o,i,a,c,l,u=r.item,s=t.getState(),f=null==u||null===(n=u.__SERVICE__)||void 0===n||null===(o=n.options)||void 0===o?void 0:o.typeName,p=f&&(0,ct.dT)(s,f),m=u.bbox||u.properties.bbox||Qe()(u),y=et()(u).geometry.coordinates,d={lng:y[0],lat:y[1]},h=u.id;return y&&(0,Be.zA)(null==u?void 0:u.__SERVICE__)&&(0,Be.Tv)(p,null==u?void 0:u.__SERVICE__)?(i=$e.Observable).of.apply(i,gt(null!=u&&null!==(a=u.__SERVICE__)&&void 0!==a&&a.forceSearchLayerVisibility&&p?[(0,ut.He)(p.id,{visibility:!0})]:[]).concat([(0,lt.lK)({latlng:d},f,[f],_t({},f,Et({info_format:wt(p,s)},h?{featureid:h,CQL_FILTER:void 0}:{})),h),(0,lt.HP)(),(0,v._q)(u)])).merge(m?e.ofType(lt.XL).take(1).mapTo((0,b.Px)([m[0],m[1],m[2],m[3]],"EPSG:4326",(null==u||null===(c=u.__SERVICE__)||void 0===c||null===(l=c.options)||void 0===l?void 0:l.maxZoomLevel)||21)).takeUntil(e.ofType(lt.Ih,lt.km)):$e.Observable.empty()).let((function(e){return m&&(0,ct._$)(t.getState())?e.startWith((0,lt.PM)(!1)).concat($e.Observable.of((0,lt.PM)(!0))):e})):$e.Observable.empty()}))},delayedSearchEpic:function(e){return e.ofType(v.qj).switchMap((function(t){var r=t.layer,n=t.cql_filter;return e.ofType(ut.oE).filter((function(e){return e.layer.name===r})).take(1).switchMap((function(){return $e.Observable.of((0,v.l4)({layer:r,cql_filter:n}))}))}))}},reducers:{search:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case v.NN:return a()({},t,{loading:r.loading});case v.O7:return a()({},t,{error:r.error});case v.gs:return a()({},t,{searchText:r.searchText,error:null});case v.p7:var n=r.results;return!0===r.append&&t&&t.results&&(n=[].concat(kt(t.results),kt(r.results))),a()({},t,{results:n,error:null});case v.Av:return a()({},t,{results:null,error:null});case v.wn:var o=r.markerPosition.latlng?{latlng:r.markerPosition.latlng,lat:r.markerPosition.latlng.lat,lng:r.markerPosition.latlng.lng}:r.markerPosition;return a()({},t,{markerPosition:o,markerLabel:r.markerLabel});case v.Gh:return a()({},t,{highlightedFeature:r.highlightedFeature});case v.M8:return{style:t.style||{}};case d.l:return null;case v.C2:return a()({},t,{selectedServices:r.services,searchText:r.searchText,selectedItems:(t.selectedItems||[]).concat(r.items)});case v.oQ:return t?a()({},{selectedItems:t.selectedItems&&t.selectedItems.filter((function(e){return e!==r.item})),searchText:""===t.searchText&&r.item&&r.item.text?r.item.text.substring(0,r.item.text.length):t.searchText}):t;case v.x2:return a()({},t,{style:r.style});case v.Y7:return Tt(Tt({},t),{},{activeSearchTool:r.activeSearchTool});case v.GI:return Tt(Tt({},t),{},{format:r.format});case v.KP:return Tt(Tt({},t),{},{coordinate:Tt(Tt({},t.coordinate),{},Ct({},r.coord,r.val))});case v.dS:return a()({},t,{markerPosition:null!=t&&null!==(e=t.markerPosition)&&void 0!==e&&e.latlng?{}:null==t?void 0:t.markerPosition});default:return t}},mapInfo:Pt.Z}}}}]);